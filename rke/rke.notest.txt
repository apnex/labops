
VMworld
- CMBU - vRNI
- NSX
- Session


ANZ Bank - VMC

GMAIL

Marcos expense

CentOS -> Docker -> Kubernetes -> ArgoCD -> Planespotter

apiVersion: v1
kind: Service
metadata:
  name: test
spec:
  clusterIP: None
  externalIPs:
    - 8.8.8.8


---
apiVersion: v1
kind: Endpoints
metadata:
  name: my-service
subsets:
  - addresses:
      - ip: 10.30
    ports:
      - port: 9376


dig @localhost kubernetes.default.svc

\cp -f ~/.ssh/id_rsa.pub /home/rke/.ssh/authorized_keys
apiVersion: v1
kind: Service
metadata:
  name: vip-kube-dns
  namespace: kube-system
  annotations:
    metallb.universe.tf/allow-shared-ip: host
spec:
    selector:
      k8s-app: kube-dns
    ports:
    - name: dns
      port: 53
      protocol: UDP
      targetPort: 53
    - name: dns-tcp
      port: 53
      protocol: TCP
      targetPort: 53
  type: LoadBalancer

## CoreDNS rewrite rule
kubectl exec -n kube-system coredns-980047985-g2748 -- kill -SIGUSR1 1
.:53 {
    errors
    log
    health
    rewrite name suffix .lab04 .lab.svc.cluster.local
    kubernetes cluster.local 10.0.0.0/24
    proxy . /etc/resolv.conf
    cache 30
}

docker run apnex/labops docker install

curl -fsSL rke.labops.sh/install
rke.labops.sh/remove
docker.labops.sh/install
docker.labops.sh/remove

curl -fsSL https://raw.githubusercontent.com/apnex/labops/master/docker/install | sh
curl -fsSL https://raw.githubusercontent.com/apnex/labops/master/rke/install | sh
curl -fsSL https://raw.githubusercontent.com/apnex/labops/master/rke/remove.sh | sh


## work out how to deploy locust as an app

## teardown rke
echo "y" | rke remove --config ./rke.config.yaml

## clear rancher images
echo "-- shutting down running containers --"
docker rm -f -v $(docker ps -qa) 2>/dev/null
echo "-- removing all images --"
docker rmi -f $(docker images -qa) 2>/dev/null
echo "-- performing docker system prune --"
docker system prune -a -f

## remove kubeconfig
rm -rf $HOME/.kube

## remove kubectl
## do a type/which to see where it is first
rm -f /usr/local/bin/kubectl

## remove rke
## do a type/which to see where it is first
rm -f /usr/local/bin/rke

## remo rke service account
userdel -r rke


### add a health check to argo.cli.install --- wait for server
